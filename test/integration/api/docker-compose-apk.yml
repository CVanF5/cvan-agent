version: '3.9'

networks:
  monitoring:
    driver: bridge

services:
  agent:
    build:
      context: ../../../
      dockerfile: ./test/docker/oss/${CONTAINER_OS_TYPE}/Dockerfile
      target: install-agent-local
      args:
        TAG: ${TAG}
        ARCH: ${OS_ARCH}
        CONTAINER_NGINX_IMAGE_REGISTRY: ${CONTAINER_NGINX_IMAGE_REGISTRY}
        CONTAINER_OS_TYPE: ${CONTAINER_OS_TYPE}
    ports:
      - 9091:9091
    networks:
      - monitoring
    # volumes:
    #   - ./nginx.conf:/etc/nginx/nginx.conf
    #   - ./nginx-agent.conf:/etc/nginx-agent/nginx-agent.conf
